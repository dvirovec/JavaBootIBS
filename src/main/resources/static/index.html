<!DOCTYPE html>
<meta charset="UTF-8">
<html lang='hr-HR'>
<head>

    <script src="../polymer/platform.js"></script>
    <script src="../script/jquery-3.1.1.min.js"></script>
    <script src="../semantic/semantic.min.js"></script>
    <script src="../ractive/ractive.min.js"></script>


    <script src="helpers.js"></script>    
    
 	<link rel="import" href="ibs_data_table.html">
 	<link rel="import" href="ibs_combo.html">

    <link rel="stylesheet" type="text/css" href="../semantic/semantic.min.css">

    <style type="text/css">

	select {
		color: blue;
		font-weight: bold;
	}

	input {
		color: blue;
		font-weight: bold;
	}
	td {
	    padding: 5px;
	}

</style>

</head>
<body>

<div id="home" ></div>

	<script id="template" type="text/ractive">

		<div style="position:fixed;top:0px;width:100%;margin:0;height: 70px;background-color: #f3f3f5;">{{user_detail.firstName}}&nbsp&nbsp{{user_detail.lastName}}</div>
	
		<div class="ui grid">

<div class="column" id="erp-menu" style="background-color:white;width:20%;top:85px;padding-right:0px;">

<div class="ui styled accordion" style="width: 100%;font-size: 16px;border-radius: 0px !important;">

  <div class="title">
    <i class="dropdown icon"></i>
    Prometni dokumenti
  </div>

<!-- -->
  <div class="content"> 	
  	<div class="ui secondary vertical menu" style="width: 100%;font-size: 16px;">
	  <a class="item">Otpremnice</a>
	  <a class="item">Računi</a>  
	</div>
 </div>
<!-- -->

  <div class="title">
    <i class="dropdown icon"></i>
    Računovodstvo
  </div>
  
  <div class="content"></div>

  <div class="title">
    <i class="dropdown icon"></i>
    Skladišno poslovanje
  </div>

  <div class="content"></div>

<div class="title">
    <i class="dropdown icon"></i>
    Kadrovi
  </div>

<div class="content">eqweqwe
</div>


<div class="active title">
    <i class="dropdown icon"></i>
    Osnovni podaci
  </div>
<div class="content" style="padding-left:50px;">
<div class="ui secondary vertical menu" style="width: 100%;font-size: 16px;">
	  <a class="item" onclick="openCurrencyForm()">Poduzeća</a>
	  <a class="item" onclick="openCompanyForm()">Valute</a>  
	</div>
</div>
</div>

</div>

	<div class="column" id="erp-document"  style="width:60%;top:70px;"></div>

	<div class="column" id="erp-tools"  style="width:20%;top:70px;"></div>
	
	</div>		
		
	</script>

    <script>

    var openCurrencyForm = ()=>{
    	openPage("./erp/base/company/company.ractive.html");	
    }	

	var openCompanyForm = ()=>{
		openPage("./erp/financial/currency/currency.ractive.html");	    	
    }


    var openPage = (page_url)=> {

	let user_id = getCookie("orbis.erp.login");
										
		if(user_id!=""){	

			$.get( "/erp/user/"+user_id, (user)=>{	

				$.get( "/erp/user_detail/"+user.id, (user_detail)=>{
						home_page.set("user_detail", user_detail);
					});					

			httpGet(page_url).then(
		        function (value) {
		            $("#erp-document").html(value);
		             setCookie("orbis.erp.last_page", page_url, 1); 		
		        },
		        function (reason) {
		            console.error('Something went wrong');
		        });			

		});
		}
		else 					
		$("#erp-document").load("./erp/system/login/login.html");			
    }

    var home_page = new Ractive({
    	el:"#home",
    	template:"#template",
    	data: {
    		user:null,
    		user_detail:null,
    	},
	   });

    		var user = null;
    		//var page_url="";
    		//var page_url="./erp/financial/currency/currency.ractive.html";
    		var page_url="./erp/base/company/company.html";
			//var page_url="inforbis.html";
    		//var page_url="./erp/travel/travel_order.ractive.html";

            //var host = "http://192.168.226.199:8080";
            //var host = "http://localhost:8080";
            var host = "";

			$(document).ready(function(){
				
				$('.ui.accordion')
 				 .accordion();					
				});
			

			let last_page = getCookie("orbis.erp.last_page");

			console.log(last_page);

			if(last_page!="") {
				openPage(last_page);
			}


		</script>


</body>
</html>